/*
 *  jQuery ZoomToo - v0.9.0
 *  Showcase your images with a magnifying lens on hover
 *  https://github.com/sevagf/zoomtoo
 *
 *  Made by Sevag Frankian
 *  Under MIT License
 */
!function(a){function b(a,b){var c=this;c.element=a,c.load(b)}b.defaults={showDuration:500,moveDuration:1200,magnify:1,lensWidth:200,lensHeight:200},b.prototype={load:function(b){var c=this,d=c.element.find("img").first(),e=d.data("src");c.element.one("zoomtoo.destroy",a.proxy(c.destroy,c)),e&&(c.img=new Image,c.img.src=e,c.img.onload=a.proxy(c.init,c,b))},init:function(c){var d=this,e=d.element.css("position");d.settings=a.extend({},b.defaults,c),d.element.get(0).style.position=/(absolute|fixed)/.test(e)?e:"relative",d.element.get(0).style.overflow="hidden",d.elementWidth=d.element.outerWidth(),d.elementHeight=d.element.outerHeight(),d.imgWidth=d.img.width*d.settings.magnify,d.imgHeight=d.img.height*d.settings.magnify,d.elementOffset=d.element.offset(),d.newZoom={left:0,top:0},d.currentZoom={left:0,top:0},d.moveImageTimer=0,d.continueSlowMove=!1,a(d.img).css({position:"absolute",top:0,left:0,opacity:0,width:d.imgWidth,height:d.imgHeight,border:"none",maxWidth:"none",maxHeight:"none"}).appendTo(d.element),d.element.css({cursor:"crosshair"}).on("mouseenter.zoomtoo",a.proxy(d.mouseEnter,d)).on("mouseleave.zoomtoo",a.proxy(d.mouseLeave,d)).on("mousemove.zoomtoo",a.proxy(d.mouseMove,d))},destroy:function(){var b=this;b.cancelTimer(),b.element.off(),a(b.img).remove(),b.element.removeData("zoomtoo")},calculateOffset:function(a){var b=this,c=a.x-b.elementOffset.left,d=a.y-b.elementOffset.top,e=Math.round(b.settings.lensHeight/2),f=Math.round(b.settings.lensWidth/2),g=d-e,h=d+e,i=c-f,j=c+f;0>g&&(d=e),h>b.elementHeight&&(d=b.elementHeight-e),0>i&&(c=f),j>b.elementWidth&&(c=b.elementWidth-f);var k=b.imgHeight-b.elementHeight,l=b.elementHeight-b.settings.lensHeight,m=b.imgWidth-b.elementWidth,n=b.elementWidth-b.settings.lensWidth,o=-k/l*(d-e),p=-m/n*(c-f);b.newZoom.left=p,b.newZoom.top=o},cancelTimer:function(){var a=this;clearTimeout(a.moveImageTimer)},stopSlowMoveImage:function(){var a=this;a.continueSlowMove=!1},mouseLeave:function(){var b=this;a(b.img).stop().fadeTo(b.settings.showDuration,0).promise().done(b.stopSlowMoveImage)},mouseEnter:function(b){var c=this,d={x:b.pageX,y:b.pageY};c.calculateOffset(d),c.continueSlowMove=!0,c.currentZoom.top=c.newZoom.top,c.currentZoom.left=c.newZoom.left,c.moveImage(),a(c.img).stop().fadeTo(c.settings.showDuration,1)},mouseMove:function(a){var b=this,c={x:a.pageX,y:a.pageY};b.calculateOffset(c),b.cancelTimer(),b.continueSlowMove=!0,b.slowMoveImage()},slowMoveImage:function(){var b=this,c={left:0,top:0},d={left:0,top:0},e=!1,f=!1;c.left=b.newZoom.left-b.currentZoom.left,c.top=b.newZoom.top-b.currentZoom.top,d.left=-c.left/(b.settings.moveDuration/100),d.top=-c.top/(b.settings.moveDuration/100),b.currentZoom.left=b.currentZoom.left-d.left,b.currentZoom.top=b.currentZoom.top-d.top,Math.abs(c.left)<1&&(b.currentZoom.left=b.newZoom.left,e=!0),Math.abs(c.top)<1&&(b.currentZoom.top=b.newZoom.top,f=!0),b.moveImage(),e&&f&&(b.continueSlowMove=!1),b.continueSlowMove===!0&&(b.moveImageTimer=setTimeout(a.proxy(b.slowMoveImage,b),25))},moveImage:function(){var a=this;a.img.style.left=a.currentZoom.left+"px",a.img.style.top=a.currentZoom.top+"px"}},a.fn.zoomToo=function(c){this.each(function(){var d=a.data(this,"zoomtoo");d||a.data(this,"zoomtoo",new b(a(this),c))})}}(window.jQuery);