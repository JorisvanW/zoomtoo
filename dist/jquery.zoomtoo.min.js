/*
 *  jQuery ZoomToo - v0.9.0
 *  Showcase your images with a magnifying lens on hover
 *  https://github.com/sevagf/zoomtoo
 *
 *  Made by Sevag Frankian
 *  Under MIT License
 */
(function(){!function(a){var b;b=function(a,b){var c;c=this,c.element=a,c.load(b)},b.defaults={showDuration:500,moveDuration:1200,magnify:1,lensWidth:200,lensHeight:200},b.prototype={load:function(b){var c,d,e;e=this,d=e.element.find("img").first(),c=d.data("src"),e.element.one("zoomtoo.destroy",a.proxy(e.destroy,e)),c&&(e.img=new Image,e.img.src=c,e.img.onload=a.proxy(e.init,e,b))},init:function(c){var d,e;e=this,d=e.element.css("position"),e.settings=a.extend({},b.defaults,c),e.element.get(0).style.position=/(absolute|fixed)/.test(d)?d:"relative",e.element.get(0).style.overflow="hidden",e.elementWidth=e.element.outerWidth(),e.elementHeight=e.element.outerHeight(),e.imgWidth=e.img.width*e.settings.magnify,e.imgHeight=e.img.height*e.settings.magnify,e.elementOffset=e.element.offset(),e.newZoom={left:0,top:0},e.currentZoom={left:0,top:0},e.moveImageTimer=0,e.continueSlowMove=!1,a(e.img).css({position:"absolute",top:0,left:0,opacity:0,width:e.imgWidth,height:e.imgHeight,border:"none",maxWidth:"none",maxHeight:"none"}).appendTo(e.element),e.element.css({cursor:"crosshair"}).on("mouseenter.zoomtoo",a.proxy(e.mouseEnter,e)).on("mouseleave.zoomtoo",a.proxy(e.mouseLeave,e)).on("mousemove.zoomtoo",a.proxy(e.mouseMove,e))},destroy:function(){var b;b=this,b.cancelTimer(),b.element.off(),a(b.img).remove(),b.element.removeData("zoomtoo")},calculateOffset:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;o=this,d=a.x-o.elementOffset.left,e=a.y-o.elementOffset.top,h=Math.round(o.settings.lensHeight/2),i=Math.round(o.settings.lensWidth/2),m=e-h,j=e+h,k=d-i,l=d+i,0>m&&(e=h),j>o.elementHeight&&(e=o.elementHeight-h),0>k&&(d=i),l>o.elementWidth&&(d=o.elementWidth-i),f=o.imgHeight-o.elementHeight,b=o.elementHeight-o.settings.lensHeight,g=o.imgWidth-o.elementWidth,c=o.elementWidth-o.settings.lensWidth,p=-f/b*(e-h),n=-g/c*(d-i),o.newZoom.left=n,o.newZoom.top=p},cancelTimer:function(){var a;a=this,clearTimeout(a.moveImageTimer)},stopSlowMoveImage:function(){var a;a=this,a.continueSlowMove=!1},mouseLeave:function(){var b;b=this,a(b.img).stop().fadeTo(b.settings.showDuration,0).promise().done(b.stopSlowMoveImage)},mouseEnter:function(b){var c,d;d=this,c={x:b.pageX,y:b.pageY},d.calculateOffset(c),d.continueSlowMove=!0,d.currentZoom.top=d.newZoom.top,d.currentZoom.left=d.newZoom.left,d.moveImage(),a(d.img).stop().fadeTo(d.settings.showDuration,1)},mouseMove:function(a){var b,c;c=this,b={x:a.pageX,y:a.pageY},c.calculateOffset(b),c.cancelTimer(),c.continueSlowMove=!0,c.slowMoveImage()},slowMoveImage:function(){var b,c,d,e,f;f=this,b={left:0,top:0},c={left:0,top:0},d=!1,e=!1,b.left=f.newZoom.left-f.currentZoom.left,b.top=f.newZoom.top-f.currentZoom.top,c.left=-b.left/(f.settings.moveDuration/100),c.top=-b.top/(f.settings.moveDuration/100),f.currentZoom.left=f.currentZoom.left-c.left,f.currentZoom.top=f.currentZoom.top-c.top,Math.abs(b.left)<1&&(f.currentZoom.left=f.newZoom.left,d=!0),Math.abs(b.top)<1&&(f.currentZoom.top=f.newZoom.top,e=!0),f.moveImage(),d&&e&&(f.continueSlowMove=!1),f.continueSlowMove===!0&&(f.moveImageTimer=setTimeout(a.proxy(f.slowMoveImage,f),25))},moveImage:function(){var a;a=this,a.img.style.left=a.currentZoom.left+"px",a.img.style.top=a.currentZoom.top+"px"}},a.fn.zoomToo=function(c){this.each(function(){var d;d=a.data(this,"zoomtoo"),d||a.data(this,"zoomtoo",new b(a(this),c))})}}(window.jQuery)}).call(this);